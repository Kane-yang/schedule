

[TOC]


### I.本地Server功能



#### 1.计算停车费用（本地和云端都可以）
- **一般情况**  都使用云端（）
- **断网情况**  使用本地（使用windows系统的容器安装web）？
- 每个停车场有不同都计费方式（计费方式时放在本地还是服务器）


#### 2.支付宝缴费
- 支付宝无感支付 （停车缴费功能）
> 当无网环境时会出现无法向支付宝后台生成订单的情况

- 需要一个线下生成支付码的方式来解决（应急情况）


#### 3. 本地数据缓存 & 网络恢复时的（缓存）数据上传


#### 4.进出门系统
- ~~找海哥~~

### II.数据表简介
#### 1.本地服务
- 白名单
	1. 白名单表（id，用户名，身份信息，支付宝账号，微信账号，微信无感支付id，支付宝无感支付id，联系电话，车牌号，车辆颜色，车牌颜色，注册时间，备注，司机头像地址，是否有包月--0:没有、1:包月、2:包年，包月结束时间，包月id，是否接受续费提醒--默认提醒--0:不提醒、1:提醒）
	2. 包月信息（id，用户id，payment--1:包月2:包年，how_long--时间长度，创建时间，开始时间，结束时间，支付方式--pay_type 0: 支付宝、1：微信，支付账号，实际支付金额--real_price，总金额，优惠）
- 结算
	1. 出入信息记录表（id，[mac地址]，时间，进出类型--type: 0 ：进 1: 出，车牌号，出入码（唯一string），备注，）云端分表
	2. 订单表（id，用户id，车牌号，停车场id--park_id，实际支付，总消费，优惠，是否包月--has_payment 0:没有  1:有，是否支付--has_pay 0：没有 1:支付，支付方式 pay_type--0:支付宝、1:微信，支付订单id，开始时间，结束时间，创建时间，出入信息的入id，出入信息的出id，）云端分表
- 基础数据
	1. 停车场信息表（id，所属系统用户id，车场名，车场位置，经度，纬度，接入时间，车场大小「有多少停车位」，描述，收费规则id）
	2.  系统用户数据表(id, 用户名，密码--加密，用户类型--admin、普通用户，)
	3. 相机基本数据表（id，停车场id，mac地址，ip地址，主辅 type  0:主 1:辅，进出口，大门编号，）
	4. 车场人员表（id，车场id，姓名，手机号，职务occupation（1:车场主，2:管理员，3:紧急联系人），性别 0:男 1:女 ）
	5. 收费规则（id，.....）
- 记录数据
	1. 照片（id，park_id，拍照时间，mac地址，车牌号，照片地址）
	2.  




